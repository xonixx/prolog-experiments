<blockquote><code><font size="2" face="Courier New"><br><br><b>son</b>(son1).<br><b>son</b>(son2).<br><br><b>daughter</b>(daughter1).<br><b>daughter</b>(daughter2).<br><br><br><b>adult</b>(father).<br><b>adult</b>(mother).<br><b>adult</b>(police).<br><br><br><b>notsafe_</b>(criminal, <font color="#808000"><i>X</i></font>) :- <font color="#808000"><i>X</i></font> \<font color="blue"><b>=</b></font> <b>police</b>.<br><b>notsafe_</b>(mother, <font color="#808000"><i>Y</i></font>) :- <b>son</b>(<font color="#808000"><i>Y</i></font>).<br><b>notsafe_</b>(father, <font color="#808000"><i>Y</i></font>) :- <b>daughter</b>(<font color="#808000"><i>Y</i></font>).<br><br><b>notsafe</b>(<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>) :- <b>notsafe_</b>(<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>); <b>notsafe_</b>(<font color="#808000"><i>Y</i></font>, <font color="#808000"><i>X</i></font>).<br><br><b>safe</b>(<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>) :- <font color="blue"><b>\+</b></font> <b>notsafe</b>(<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>).<br><br><b>safebridge</b>([<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>]) :- (<b>adult</b>(<font color="#808000"><i>X</i></font>); <b>adult</b>(<font color="#808000"><i>Y</i></font>)), <b>safe</b>(<font color="#808000"><i>X</i></font>, <font color="#808000"><i>Y</i></font>), <font color="blue"><b>!</b></font>.<br><b>safebridge</b>([<font color="#808000"><i>X</i></font>]) :- <b>adult</b>(<font color="#808000"><i>X</i></font>).<br><br><br><b>all</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;son1, son2, father, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;daughter1, daughter2, mother,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;criminal, police<br>&nbsp;&nbsp;&nbsp;&nbsp;]).<br><br><br><b>allsafe</b>(<font color="#808000"><i>L</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>forall</b></font>(<font color="blue"><b>member</b></font>(<font color="#808000"><i>H</i></font>, <font color="#808000"><i>L</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(      <b>adult</b>(<font color="#808000"><i>H</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;      <b>son</b>(<font color="#808000"><i>H</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="blue"><b>member</b></font>(mother, <font color="#808000"><i>L</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="blue"><b>member</b></font>(father, <font color="#808000"><i>L</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>true</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;      <b>daughter</b>(<font color="#808000"><i>H</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="blue"><b>member</b></font>(father, <font color="#808000"><i>L</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="blue"><b>member</b></font>(mother, <font color="#808000"><i>L</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>true</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;      <font color="#808000"><i>H</i></font> <font color="blue"><b>=</b></font> criminal, <font color="blue"><b>member</b></font>(police, <font color="#808000"><i>L</i></font>)          <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)), <font color="blue"><b>!</b></font>.<br><b>allsafe</b>([_]).<br><b>allsafe</b>([]).<br><br><b>allPairs</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>], [<font color="#808000"><i>H</i></font>, <font color="#808000"><i>P2</i></font>]) :-<br>&nbsp;<font color="blue"><b>member</b></font>(<font color="#808000"><i>P2</i></font>, <font color="#808000"><i>T</i></font>).<br><br><b>allPairs</b>([_ | <font color="#808000"><i>T</i></font>], <font color="#808000"><i>P</i></font>) :-<br>&nbsp;<b>allPairs</b>(<font color="#808000"><i>T</i></font>, <font color="#808000"><i>P</i></font>).<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><b>step_</b>(<b>state</b>(<font color="#808000"><i>Left1</i></font>, left), <b>state</b>(<font color="#808000"><i>Left2</i></font>, right)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <b>allPairs</b>(<font color="#808000"><i>Left1</i></font>, <font color="#808000"><i>OnBridge</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>member</b></font>(<font color="#808000"><i>A</i></font>, <font color="#808000"><i>Left1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>OnBridge</i></font> <font color="blue"><b>=</b></font> [<font color="#808000"><i>A</i></font>]<br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>safebridge</b>(<font color="#808000"><i>OnBridge</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>subtract</b></font>(<font color="#808000"><i>Left1</i></font>, <font color="#808000"><i>OnBridge</i></font>, <font color="#808000"><i>Left2</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>allsafe</b>(<font color="#808000"><i>Left2</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>all</b>(<font color="#808000"><i>All</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>subtract</b></font>(<font color="#808000"><i>All</i></font>, <font color="#808000"><i>Left2</i></font>, <font color="#808000"><i>Right</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>allsafe</b>(<font color="#808000"><i>Right</i></font>).<br><br><b>step</b>(<b>state</b>(<font color="#808000"><i>Left1</i></font>, left), <b>state</b>(<font color="#808000"><i>Left2</i></font>, right)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>step_</b>(<b>state</b>(<font color="#808000"><i>Left1</i></font>, left), <b>state</b>(<font color="#808000"><i>Left2</i></font>, right)).<br><br><b>step</b>(<b>state</b>(<font color="#808000"><i>Left1</i></font>, right), <b>state</b>(<font color="#808000"><i>Left2</i></font>, left)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>all</b>(<font color="#808000"><i>All</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>subtract</b></font>(<font color="#808000"><i>All</i></font>, <font color="#808000"><i>Left1</i></font>, <font color="#808000"><i>Right1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>step_</b>(<b>state</b>(<font color="#808000"><i>Right1</i></font>, left), <b>state</b>(<font color="#808000"><i>Right2</i></font>, right)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>subtract</b></font>(<font color="#808000"><i>All</i></font>, <font color="#808000"><i>Right2</i></font>, <font color="#808000"><i>Left2</i></font>).<br><br><b>notequal</b>(<b>state</b>(<font color="#808000"><i>L1</i></font>, <font color="#808000"><i>P1</i></font>), <b>state</b>(<font color="#808000"><i>L2</i></font>, <font color="#808000"><i>P2</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>\+</b></font> (<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>P1</i></font> <font color="blue"><b>=</b></font> <font color="#808000"><i>P2</i></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sort</b>(<font color="#808000"><i>L1</i></font>, <font color="#808000"><i>L</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sort</b>(<font color="#808000"><i>L2</i></font>, <font color="#808000"><i>L</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br><b>solve</b>(<font color="#808000"><i>Inp</i></font>, <font color="#808000"><i>Outp</i></font>, <font color="#808000"><i>PrevSteps</i></font>, [<font color="#808000"><i>Step</i></font> | <font color="#808000"><i>Steps</i></font>]) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>Step</i></font> <font color="blue"><b>=</b></font> <b>step</b>(<font color="#808000"><i>Inp</i></font>, <font color="#808000"><i>S1</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>Step</i></font>, <font color="blue"><b>forall</b></font>(<font color="blue"><b>member</b></font>(<b>step</b>(<font color="#808000"><i>State1</i></font>, _), <font color="#808000"><i>PrevSteps</i></font>), <b>notequal</b>(<font color="#808000"><i>State1</i></font>, <font color="#808000"><i>S1</i></font>)), <font color="#909090"><i>% to prevent loops </i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>S1</i></font> <font color="blue"><b>=</b></font> <font color="#808000"><i>Outp</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="#808000"><i>Steps</i></font> <font color="blue"><b>=</b></font> []<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <b>solve</b>(<font color="#808000"><i>S1</i></font>, <font color="#808000"><i>Outp</i></font>, [<font color="#808000"><i>Step</i></font> | <font color="#808000"><i>PrevSteps</i></font>], <font color="#808000"><i>Steps</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;).<br><br><b>solve</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>all</b>(<font color="#808000"><i>All</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>findall</b></font>(<font color="#808000"><i>Steps</i></font>, <b>solve</b>(<b>state</b>(<font color="#808000"><i>All</i></font>, left), <b>state</b>([], _), [], <font color="#808000"><i>Steps</i></font>), <font color="#808000"><i>Solutions</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>length</b>(<font color="#808000"><i>Solutions</i></font>, <font color="#808000"><i>SolLength</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>format</b></font>(<font color="#008000">'Found ~w solutions:~n'</font>, [<font color="#808000"><i>SolLength</i></font>]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>forall</b></font>(<font color="blue"><b>member</b></font>(<font color="#808000"><i>Solution</i></font>, <font color="#808000"><i>Solutions</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(      <font color="blue"><b>format</b></font>(<font color="#008000">'~nSolution:~n'</font>),      <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>forall</b></font>(<font color="blue"><b>member</b></font>(<font color="#808000"><i>Step</i></font>, <font color="#808000"><i>Solution</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>printStep</b>(<font color="#808000"><i>Step</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br><br><b>printStep</b>(<b>step</b>(<b>state</b>(<font color="#808000"><i>L1</i></font>, <font color="#808000"><i>Pos1</i></font>), <b>state</b>(<font color="#808000"><i>L2</i></font>, _))) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>Pos1</i></font> <font color="blue"><b>=</b></font> left<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="blue"><b>subtract</b></font>(<font color="#808000"><i>L1</i></font>, <font color="#808000"><i>L2</i></font>, <font color="#808000"><i>Moved</i></font>),  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>format</b></font>(<font color="#008000">'~w -> left: ~w~n'</font>, [<font color="#808000"><i>Moved</i></font>, <font color="#808000"><i>L2</i></font>])<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="#808000"><i>Pos1</i></font> <font color="blue"><b>=</b></font> right<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="blue"><b>subtract</b></font>(<font color="#808000"><i>L2</i></font>, <font color="#808000"><i>L1</i></font>, <font color="#808000"><i>Moved</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>format</b></font>(<font color="#008000">'~w <- left: ~w~n'</font>, [<font color="#808000"><i>Moved</i></font>, <font color="#808000"><i>L2</i></font>])<br>&nbsp;&nbsp;&nbsp;&nbsp;).<br><br><br><br><br><br><br><br><br><br><br><br><br></font></code></blockquote>