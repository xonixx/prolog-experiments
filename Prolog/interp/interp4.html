<blockquote><code><font size="2" face="Courier New">:- <font color="blue"><b>style_check</b></font>(-<font color="blue"><b>atom</b></font>). <font color="#909090"><i>% long strings <b>embedded</b></i></font><br>:- <font color="blue"><b>dynamic</b></font> [eq/3, <font color="#909090"><i>% <b>level</b>, <b>name</b>, value</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcs/2, <font color="#909090"><i>% <b>fname</b>, <b>fargs</b>, fcode</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level/1 <font color="#909090"><i>% stack depth</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br>:- <font color="blue"><b>use_module</b></font>(pr).<br><br><b>level</b>(0).<br><br><b>errorRun</b>(<font color="#808000"><i>S</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>wr</b>(<font color="#008000">'Error: '</font>), <b>pr</b>(<font color="#808000"><i>S</i></font>).<br><br><b>set</b>(<font color="#808000"><i>Functor</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>Functor</i></font> <font color="blue"><b>=</b></font>.. [<font color="#808000"><i>PredName</i></font>, <font color="#808000"><i>PredKey</i></font>, _],<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>FunctorDel</i></font> <font color="blue"><b>=</b></font>.. [<font color="#808000"><i>PredName</i></font>, <font color="#808000"><i>PredKey</i></font>, _],<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<font color="#808000"><i>FunctorDel</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<font color="#808000"><i>Functor</i></font>).<br><br><font color="#909090"><i>%%</i></font><br><font color="#909090"><i>%</i></font><br><font color="#909090"><i>%    <b>setFuncVars</b>(<font color="#808000"><i>FargNames</i></font>, <font color="#808000"><i>Fargs</i></font>)</i></font><br><font color="#909090"><i>%    </i></font><br><font color="#909090"><i>%    </i></font><br><b>setFuncVars</b>(<font color="#808000"><i>FargNames</i></font>, <font color="#808000"><i>Fargs</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>dbg</b>([<font color="#008000">'setFuncVars: '</font>, <font color="#808000"><i>FargNames</i></font>,<font color="#008000">' '</font>, <font color="#808000"><i>Fargs</i></font>]), <font color="blue"><b>fail</b></font>.<br><br><b>setFuncVars</b>((<font color="#808000"><i>Name</i></font>, <font color="#808000"><i>NameOth</i></font>), [<font color="#808000"><i>Val</i></font> | <font color="#808000"><i>ValOth</i></font>]) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>setFuncVars</b>(<font color="#808000"><i>Name</i></font>, [<font color="#808000"><i>Val</i></font>]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>setFuncVars</b>(<font color="#808000"><i>NameOth</i></font>, <font color="#808000"><i>ValOth</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>setFuncVars</b>(<font color="#808000"><i>Name</i></font>, [<font color="#808000"><i>Val</i></font>]) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>level</b>(<font color="#808000"><i>N</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>Val</i></font>, <font color="#808000"><i>Val1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<b>eq</b>(<font color="#808000"><i>N</i></font>, <font color="#808000"><i>Name</i></font>, _)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<b>eq</b>(<font color="#808000"><i>N</i></font>, <font color="#808000"><i>Name</i></font>, <font color="#808000"><i>Val1</i></font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><font color="#909090"><i>%%</i></font><br><font color="#909090"><i>%</i></font><br><font color="#909090"><i>%    eval</i></font><br><font color="#909090"><i>%    </i></font><br><font color="#909090"><i>%    </i></font><br><b>eval</b>(<font color="#808000"><i>B</i></font>, _) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>dbg</b>([<font color="#008000">'eval: '</font>, <font color="#808000"><i>B</i></font>]), <font color="blue"><b>fail</b></font>.<br><br><b>eval</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>number</b></font>(<font color="#808000"><i>B</i></font>), <font color="blue"><b>!</b></font>.<br><br><font color="#909090"><i>% and</i></font><br><b>eval</b>((<font color="#808000"><i>A1</i></font>, <font color="#808000"><i>A2</i></font>), <font color="#808000"><i>B1</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>A1</i></font>, <font color="#808000"><i>A1Res</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>A1Res</i></font><font color="blue"><b>=</b></font>0<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="#808000"><i>B1</i></font><font color="blue"><b>=</b></font>0<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <b>eval</b>(<font color="#808000"><i>A2</i></font>, <font color="#808000"><i>B1</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><font color="#909090"><i>% or</i></font><br><b>eval</b>((<font color="#808000"><i>A1</i></font>; <font color="#808000"><i>A2</i></font>), <font color="#808000"><i>B1</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>A1</i></font>, <font color="#808000"><i>A1Res</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>A1Res</i></font><font color="blue"><b>=</b></font>0<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <b>eval</b>(<font color="#808000"><i>A2</i></font>, <font color="#808000"><i>B1</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="#808000"><i>B1</i></font><font color="blue"><b>=</b></font>1<br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><b>eval</b>(<b>call</b>(<font color="#808000"><i>B</i></font>), <font color="#808000"><i>B1</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>B</i></font> <font color="blue"><b>=</b></font>.. [<font color="#808000"><i>Fname</i></font> | <font color="#808000"><i>Fargs</i></font>],<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <b>funcs</b>(<font color="#808000"><i>Fname</i></font>, <b>func</b>(<font color="#808000"><i>FargNames</i></font>, <font color="#808000"><i>Fcode</i></font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <b>evalArr</b>(<font color="#808000"><i>Fargs</i></font>, <font color="#808000"><i>FargsEvaled</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>level</b>(<font color="#808000"><i>N</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>N1</i></font> <font color="blue"><b>is</b></font> <font color="#808000"><i>N</i></font>+1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<b>level</b>(_)),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<b>level</b>(<font color="#808000"><i>N1</i></font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>setFuncVars</b>(<font color="#808000"><i>FargNames</i></font>, <font color="#808000"><i>FargsEvaled</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>catch</b></font>(<b>run</b>(<font color="#808000"><i>Fcode</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b>(<font color="#808000"><i>Ret</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>B1</i></font> <font color="blue"><b>=</b></font> <font color="#808000"><i>Ret</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<b>level</b>(_)),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<b>level</b>(<font color="#808000"><i>N</i></font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>fail</b></font>    <br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>eval</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>B</i></font> <font color="blue"><b>=</b></font>.. [<font color="#808000"><i>Op</i></font>, <font color="#808000"><i>A1</i></font>, <font color="#808000"><i>A2</i></font>],<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>A1</i></font>, <font color="#808000"><i>A11</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>A2</i></font>, <font color="#808000"><i>A22</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>B0</i></font> <font color="blue"><b>=</b></font>.. [<font color="#808000"><i>Op</i></font>, <font color="#808000"><i>A11</i></font>, <font color="#808000"><i>A22</i></font>],<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="blue"><b>member</b></font>(<font color="#808000"><i>Op</i></font>, [+, -, *, /, //, mod])<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="#808000"><i>B1</i></font> <font color="blue"><b>is</b></font> <font color="#808000"><i>B0</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>member</b></font>(<font color="#808000"><i>Op</i></font>, [<, >, <font color="blue"><b>=</b></font><, ><font color="blue"><b>=</b></font>, <font color="blue"><b>=</b></font>:<font color="blue"><b>=</b></font>, <font color="blue"><b>=</b></font>\<font color="blue"><b>=</b></font>])<br>&nbsp;&nbsp;&nbsp;&nbsp;->  (<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>B0</i></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;->  <font color="#808000"><i>B1</i></font><font color="blue"><b>=</b></font>1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="#808000"><i>B1</i></font><font color="blue"><b>=</b></font>0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>eval</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>atom</b></font>(<font color="#808000"><i>B</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>level</b>(<font color="#808000"><i>L</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eq</b>(<font color="#808000"><i>L</i></font>, <font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><br><b>eval</b>(<font color="#808000"><i>B</i></font>, _) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>throw</b></font>(<b>interp_error</b>(<b>eval</b>, <font color="#808000"><i>B</i></font>, <font color="#008000">''</font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>evalArr</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>], [<font color="#808000"><i>Hevaled</i></font> | <font color="#808000"><i>Tevaled</i></font>]) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>H</i></font>, <font color="#808000"><i>Hevaled</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>evalArr</b>(<font color="#808000"><i>T</i></font>, <font color="#808000"><i>Tevaled</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>evalArr</b>([], []):-<font color="blue"><b>!</b></font>.<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="#909090"><i>%%    </i></font><br><font color="#909090"><i>%</i></font><br><font color="#909090"><i>%    runStmt</i></font><br><font color="#909090"><i>%    </i></font><br><font color="#909090"><i>%    </i></font><br><b>runStmt</b>(<font color="#808000"><i>A</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>dbg</b>([<font color="#008000">'runStmt: '</font>, <font color="#808000"><i>A</i></font>]), <font color="blue"><b>fail</b></font>.<br><br><b>runStmt</b>({}) :-<font color="blue"><b>!</b></font>.<br><b>runStmt</b>({<font color="#808000"><i>Code</i></font>}) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>run</b>(<font color="#808000"><i>Code</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<font color="#808000"><i>A</i></font><font color="blue"><b>=</b></font><font color="#808000"><i>B</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="blue"><b>atom</b></font>(<font color="#808000"><i>A</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <b>eval</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>level</b>(<font color="#808000"><i>L</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<b>eq</b>(<font color="#808000"><i>L</i></font>, <font color="#808000"><i>A</i></font>, _)),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<b>eq</b>(<font color="#808000"><i>L</i></font>, <font color="#808000"><i>A</i></font>, <font color="#808000"><i>B1</i></font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <b>errorRun</b>([<font color="#808000"><i>A</i></font>, <font color="#008000">' is not var'</font>])),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<font color="blue"><b>write</b></font>(<b>str</b>(<font color="#808000"><i>S</i></font>))) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#808000"><i>S</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><b>runStmt</b>(<font color="blue"><b>write</b></font>(<font color="#808000"><i>A</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>A</i></font>, <font color="#808000"><i>A1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#808000"><i>A1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>for</b>(<font color="#808000"><i>Start</i></font>, <font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Step</i></font>, <font color="#808000"><i>Code</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>run</b>(<font color="#808000"><i>Start</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>repeat</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;(      <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>CondRes</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>CondRes</i></font><font color="blue"><b>=</b></font>1<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <b>run</b>(<font color="#808000"><i>Code</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>run</b>(<font color="#808000"><i>Step</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>fail</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;;   <font color="blue"><b>true</b></font>, <font color="blue"><b>!</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>while</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Code</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runStmt</b>(<b>for</b>({}, <font color="#808000"><i>Cond</i></font>, {}, <font color="#808000"><i>Code</i></font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>if</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Code</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runStmt</b>(<b>if</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Code</i></font>, {})),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>if</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Code</i></font>, <font color="#808000"><i>CodeElse</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>CondRes</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;(   <font color="#808000"><i>CondRes</i></font><font color="blue"><b>=</b></font>1<br>&nbsp;&nbsp;&nbsp;&nbsp;->  <b>run</b>(<font color="#808000"><i>Code</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;;   <b>run</b>(<font color="#808000"><i>CodeElse</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>function</b>(<font color="#808000"><i>Fname</i></font>, <font color="#808000"><i>Fargs</i></font>, <font color="#808000"><i>Fcode</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>set</b>(<b>funcs</b>(<font color="#808000"><i>Fname</i></font>, <b>func</b>(<font color="#808000"><i>Fargs</i></font>, <font color="#808000"><i>Fcode</i></font>))),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<b>return</b>(<font color="#808000"><i>B</i></font>)) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>eval</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>throw</b></font>(<b>return</b>(<font color="#808000"><i>B1</i></font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runStmt</b>(<font color="#808000"><i>Stmt</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>throw</b></font>(<b>interp_error</b>(<b>runStmt</b>, <font color="#808000"><i>Stmt</i></font>, <font color="#008000">''</font>)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>runSafe</b>(<font color="#808000"><i>Code</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>retractall</b></font>(<b>level</b>(0)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>assert</b></font>(<b>level</b>(0)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>catch</b></font>(<b>run</b>(<font color="#808000"><i>Code</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>interp_error</b>(<font color="#808000"><i>Meth</i></font>, <font color="#808000"><i>Args</i></font>, <font color="#808000"><i>Msg</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(      <b>errorRun</b>([<font color="#008000">'Method: ###s#0 with args: '</font>, <font color="#808000"><i>Args</i></font>,<font color="#008000">': '</font>, <font color="#808000"><i>Msg</i></font>])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>run</b>(<font color="#808000"><i>Code</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>dbg</b>([<font color="#008000">'run: '</font>, <font color="#808000"><i>Code</i></font>]), <font color="blue"><b>fail</b></font>.<br><br><b>run</b>(<font color="#808000"><i>Code</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;( <font color="#808000"><i>Stmt</i></font>, <font color="#808000"><i>OtherStmts</i></font> ) <font color="blue"><b>=</b></font> <font color="#808000"><i>Code</i></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runStmt</b>(<font color="#808000"><i>Stmt</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>run</b>(<font color="#808000"><i>OtherStmts</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>run</b>(<font color="#808000"><i>Stmt</i></font>) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runStmt</b>(<font color="#808000"><i>Stmt</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>testEul1</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>((<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="blue"><b>=</b></font>0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum<font color="blue"><b>=</b></font>0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>while</b>(n<1000, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>((n mod 5 <font color="blue"><b>=</b></font>:<font color="blue"><b>=</b></font> 0; n mod 3 <font color="blue"><b>=</b></font>:<font color="blue"><b>=</b></font> 0),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum <font color="blue"><b>=</b></font> sum + n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n <font color="blue"><b>=</b></font> n + 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(sum)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br><br><b>test3</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>((<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>(5<2, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'true'</font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'false'</font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br><br><b>test2</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>((<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>function</b>(<b>add</b>, (<b>a</b>, b), {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b>(a+b)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c<font color="blue"><b>=</b></font>2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<b>call</b>(<b>add</b>(<b>c</b>, 5)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br><br><b>test1</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<font color="blue"><b>=</b></font>10,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b<font color="blue"><b>=</b></font>20+10/2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c<font color="blue"><b>=</b></font>a+<b>b</b>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(c)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br><br><b>test</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(   <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum <font color="blue"><b>=</b></font> 0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>for</b>(i<font color="blue"><b>=</b></font>0, i<10, i<font color="blue"><b>=</b></font>i+1,  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum <font color="blue"><b>=</b></font> sum + i            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'sum='</font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(sum)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br><br><b>testFib</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>((<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>function</b>(<b>fib</b>,<b>n</b>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>(n<2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b>(n)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b>(<b>call</b>(<b>fib</b>(n-1))+<b>call</b>(<b>fib</b>(n-2)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>for</b>(i<font color="blue"><b>=</b></font>1,i<font color="blue"><b>=</b></font><10,i<font color="blue"><b>=</b></font>i+1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<b>str</b>(<font color="#008000">'fib('</font>)),<font color="blue"><b>write</b></font>(i),<font color="blue"><b>write</b></font>(<b>str</b>(<font color="#008000">')='</font>)),<font color="blue"><b>write</b></font>(<b>call</b>(<b>fib</b>(i))),<font color="blue"><b>write</b></font>(<b>str</b>(<font color="#008000">'\n'</font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br><br><b>testFibDCG</b> :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>CodeString</i></font> <font color="blue"><b>=</b></font> <font color="#008000"><b>"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function fib(n) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (n<2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(n)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(fib(n-1)+fib(n-2))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i=1; i<=10; i=i+1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write('fib(');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(')=');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(fib(i));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write('\n')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'Code:\n'</font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>string_to_atom</b>(<font color="#808000"><i>CodeStringA</i></font>, <font color="#808000"><i>CodeString</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#808000"><i>CodeStringA</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'\nCompilling:\n'</font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>phrase</b>(<b>code</b>(<font color="#808000"><i>Code</i></font>), <font color="#808000"><i>CodeString</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#808000"><i>Code</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>write</b></font>(<font color="#008000">'\nRunning...\n'</font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>runSafe</b>(<font color="#808000"><i>Code</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>code</b>(<font color="#808000"><i>Stmts</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>whitespace</b>, <b>statements</b>(<font color="#808000"><i>Stmts</i></font>).<br><br><b>code</b>({<font color="#808000"><i>Code</i></font>}) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"{"</b></font>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>statements</b>(<font color="#808000"><i>Code</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"}"</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br><br><b>code</b>({}) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"{"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"}"</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br><br><b>statements</b>((<font color="#808000"><i>Stmt</i></font>, <font color="#808000"><i>Stmts</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>statement</b>(<font color="#808000"><i>Stmt</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>separator</b>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>statements</b>(<font color="#808000"><i>Stmts</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statements</b>(<font color="#808000"><i>Stmt</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>statement</b>(<font color="#808000"><i>Stmt</i></font>).<br><br><b>statement</b>((<font color="#808000"><i>A</i></font><font color="blue"><b>=</b></font><font color="#808000"><i>B</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifier</b>(<font color="#808000"><i>A</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"="</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>expression</b>(<font color="#808000"><i>B</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<b>function</b>(<font color="#808000"><i>Fname</i></font>, <font color="#808000"><i>Fargs</i></font>, <font color="#808000"><i>Fcode</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"function"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>whitespace</b>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifier</b>(<font color="#808000"><i>Fname</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>functionArgs</b>(<font color="#808000"><i>Fargs</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code</b>(<font color="#808000"><i>Fcode</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<b>if</b>(<font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>IfCode</i></font>, <font color="#808000"><i>ElseCode</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"if"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>parenthExpression</b>(<font color="#808000"><i>Cond</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code</b>(<font color="#808000"><i>IfCode</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>elseStmt</b>(<font color="#808000"><i>ElseCode</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<b>for</b>(<font color="#808000"><i>Start</i></font>, <font color="#808000"><i>Cond</i></font>, <font color="#808000"><i>Step</i></font>, <font color="#808000"><i>Code</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"for"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"("</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>statements</b>(<font color="#808000"><i>Start</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>";"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>expression</b>(<font color="#808000"><i>Cond</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>";"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>statements</b>(<font color="#808000"><i>Step</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>")"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code</b>(<font color="#808000"><i>Code</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<font color="blue"><b>write</b></font>(<font color="#808000"><i>Expr</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>statement0</b>(<font color="#808000"><i>Expr</i></font>, <font color="#008000"><b>"write"</b></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<b>return</b>(<font color="#808000"><i>Expr</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>statement0</b>(<font color="#808000"><i>Expr</i></font>, <font color="#008000"><b>"return"</b></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>statement</b>(<b>call</b>(<font color="#808000"><i>Functor</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>expression</b>(<b>call</b>(<font color="#808000"><i>Functor</i></font>)).<br><br><b>statement0</b>(<font color="#808000"><i>Expr</i></font>, <font color="#808000"><i>Word</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>Word</i></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>parenthExpression</b>(<font color="#808000"><i>Expr</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br><br><b>elseStmt</b>(<font color="#808000"><i>ElseCode</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"else"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code</b>(<font color="#808000"><i>ElseCode</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br><b>elseStmt</b>({}) --> [].<br><br><b>functionArgs</b>(<font color="#808000"><i>Fargs</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"("</b></font>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifiers</b>(<font color="#808000"><i>IdArr</i></font>, <font color="#008000"><b>","</b></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>")"</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]), <br>&nbsp;&nbsp;&nbsp;&nbsp;{ <b>arrToTuple</b>(<font color="#808000"><i>Fargs</i></font>, <font color="#808000"><i>IdArr</i></font>) }.<br><br><b>arrToTuple</b>((<font color="#808000"><i>A</i></font>, <font color="#808000"><i>B</i></font>), [<font color="#808000"><i>A</i></font> | <font color="#808000"><i>B1</i></font>]) :-<br>&nbsp;&nbsp;&nbsp;&nbsp;<b>arrToTuple</b>(<font color="#808000"><i>B</i></font>, <font color="#808000"><i>B1</i></font>), <font color="blue"><b>!</b></font>.<br><br><b>arrToTuple</b>(<font color="#808000"><i>A</i></font>, [<font color="#808000"><i>A</i></font>]).<br><br><b>identifiers</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>], <font color="#808000"><i>Separator</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifier</b>(<font color="#808000"><i>H</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>Separator</i></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifiers</b>(<font color="#808000"><i>T</i></font>, <font color="#808000"><i>Separator</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><br><b>identifiers</b>([<font color="#808000"><i>H</i></font>], _) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>identifier</b>(<font color="#808000"><i>H</i></font>).<br><br><b>identifier</b>(<font color="#808000"><i>A</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;[<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>],<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code_type</b>(<font color="#808000"><i>H</i></font>, alpha),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(   <b>alnum</b>(<font color="#808000"><i>T</i></font>); <font color="#808000"><i>T</i></font><font color="blue"><b>=</b></font><font color="#008000"><b>""</b></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>string_to_atom</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>], <font color="#808000"><i>A</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;}.<br><br><b>parenthExpression</b>(<font color="#808000"><i>Expr</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"("</b></font>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>expression</b>(<font color="#808000"><i>Expr</i></font>), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>")"</b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br><br><b>expression</b>(<font color="#808000"><i>Expr</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>expression0</b>(<font color="#808000"><i>A</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>operand</b>(<font color="#808000"><i>Op</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>expression</b>(<font color="#808000"><i>Expr0</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;{<font color="#808000"><i>Expr</i></font><font color="blue"><b>=</b></font>..[<font color="#808000"><i>Op</i></font>, <font color="#808000"><i>A</i></font>, <font color="#808000"><i>Expr0</i></font>]}, <font color="blue"><b>!</b></font>.<br><b>expression</b>(<font color="#808000"><i>Expr</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>expression0</b>(<font color="#808000"><i>Expr</i></font>).<br><br><b>expression0</b>(<b>call</b>(<font color="#808000"><i>Functor</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>w</b>([<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>identifier</b>(<font color="#808000"><i>Ident</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>parenthExpression</b>(<font color="#808000"><i>Expr</i></font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),<br>&nbsp;&nbsp;&nbsp;&nbsp;{<font color="#808000"><i>Functor</i></font><font color="blue"><b>=</b></font>..[<font color="#808000"><i>Ident</i></font>, <font color="#808000"><i>Expr</i></font>]}, <br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><b>expression0</b>(<font color="#808000"><i>I</i></font>) --> <b>integer</b>(<font color="#808000"><i>I</i></font>), <font color="blue"><b>!</b></font>.<br><b>expression0</b>(<b>str</b>(<font color="#808000"><i>S</i></font>)) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000"><b>"'"</b></font>,[<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>],<font color="#008000"><b>"'"</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;{<b>string_to_atom</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>], <font color="#808000"><i>S</i></font>)},<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue"><b>!</b></font>.<br><b>expression0</b>(<font color="#808000"><i>A</i></font>) --> <b>identifier</b>(<font color="#808000"><i>A</i></font>).<br><br><b>integer</b>(<font color="#808000"><i>I</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>digit</b>(<font color="#808000"><i>D0</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>digits</b>(<font color="#808000"><i>D</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <b>number_chars</b>(<font color="#808000"><i>I</i></font>, [<font color="#808000"><i>D0</i></font>|<font color="#808000"><i>D</i></font>])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br><br><b>digits</b>([<font color="#808000"><i>D</i></font>|<font color="#808000"><i>T</i></font>]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>digit</b>(<font color="#808000"><i>D</i></font>), <font color="blue"><b>!</b></font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>digits</b>(<font color="#808000"><i>T</i></font>).<br><b>digits</b>([]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[].<br><br><b>digit</b>(<font color="#808000"><i>D</i></font>) --><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<font color="#808000"><i>D</i></font>],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <b>code_type</b>(<font color="#808000"><i>D</i></font>, digit)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><b>operand</b>(+) --> <font color="#008000"><b>"+"</b></font>.<br><b>operand</b>(-) --> <font color="#008000"><b>"-"</b></font>.<br><b>operand</b>(*) --> <font color="#008000"><b>"*"</b></font>.<br><b>operand</b>(/) --> <font color="#008000"><b>"/"</b></font>.<br><b>operand</b>(<) --> <font color="#008000"><b>"<"</b></font>.<br><b>operand</b>(>) --> <font color="#008000"><b>">"</b></font>.<br><b>operand</b>(<font color="blue"><b>=</b></font><) --> <font color="#008000"><b>"<="</b></font>.<br><b>operand</b>(><font color="blue"><b>=</b></font>) --> <font color="#008000"><b>">="</b></font>.<br><b>operand</b>(<font color="blue"><b>=</b></font>:<font color="blue"><b>=</b></font>) --> <font color="#008000"><b>"=="</b></font>.<br><b>operand</b>(<font color="blue"><b>=</b></font>\<font color="blue"><b>=</b></font>) --> <font color="#008000"><b>"!="</b></font>.<br><br><b>alnum</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>]) :- <b>code_type</b>(<font color="#808000"><i>H</i></font>, alnum), <b>alnum</b>(<font color="#808000"><i>T</i></font>), <font color="blue"><b>!</b></font>.<br><b>alnum</b>([]).<br><br>separator --><br>&nbsp;&nbsp;&nbsp;&nbsp;( <font color="#008000"><b>";"</b></font>; <font color="#008000"><b>"\n"</b></font>  ).<br><br>whitespace --><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>whitespace</b>(_).<br><br><b>whitespace</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;[<font color="#808000"><i>H</i></font>], <b>whitespace</b>(<font color="#808000"><i>T</i></font>),<br>&nbsp;&nbsp;&nbsp;&nbsp;{<b>code_type</b>(<font color="#808000"><i>H</i></font>, space)}, <font color="blue"><b>!</b></font>.<br><b>whitespace</b>([]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;[].<br><br><b>w</b>([<font color="#808000"><i>H</i></font> | <font color="#808000"><i>T</i></font>]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#808000"><i>H</i></font>, <b>whitespace</b>, <b>w</b>(<font color="#808000"><i>T</i></font>).<br><b>w</b>([]) --><br>&nbsp;&nbsp;&nbsp;&nbsp;[].<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></font></code></blockquote>